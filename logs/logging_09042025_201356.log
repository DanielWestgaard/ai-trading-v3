09-04-2025 20:13:56 - INFO - Logging system initialized. Environment: development
09-04-2025 20:13:56 - INFO - Model loaded from model_registry/model_storage/xgboost_20250403_102300_20250403_102301.pkl
09-04-2025 20:13:56 - INFO - Successfully loaded model from model_registry/model_storage/xgboost_20250403_102300_20250403_102301.pkl
09-04-2025 20:13:56 - INFO - Found 40 features embedded in the model
09-04-2025 20:13:56 - INFO - Loaded credentials. Length: 3
09-04-2025 20:13:56 - INFO - Starting session with Capital.com...
09-04-2025 20:13:56 - INFO - About to start a new session.
09-04-2025 20:13:56 - INFO - Using encrypted password to start session.
09-04-2025 20:13:57 - INFO - AccountID and/or all_accounts is None. Initializing them now.
09-04-2025 20:13:57 - INFO - Will not print out response of all accounts.
09-04-2025 20:13:57 - INFO - Found accountId matching account USD_testing!
09-04-2025 20:13:57 - INFO - Successfully switched to account USD_testing!
09-04-2025 20:13:57 - INFO - Switched to demo account
09-04-2025 20:13:57 - INFO - Data processor thread started
09-04-2025 20:13:57 - INFO - LiveDataHandler processor thread started
09-04-2025 20:13:57 - INFO - Subscribing to GBPUSD MINUTE data with integrated data pipeline...
09-04-2025 20:13:57 - INFO - Data will be saved to: /Users/dmartinsen/pers-prog/ai-trading-v3/live/temp_live/live_data_GBPUSD_MINUTE_20250409_201357.csv
09-04-2025 20:13:57 - INFO - About to initiate subscribtion to live market data...
09-04-2025 20:13:57 - INFO - Websocket connected
09-04-2025 20:14:00 - DEBUG - Processing bid message with timestamp 1744222380000
09-04-2025 20:14:00 - DEBUG - Stored bid data for timestamp 1744222380000
09-04-2025 20:14:00 - DEBUG - Processing ask message with timestamp 1744222380000
09-04-2025 20:14:00 - DEBUG - Stored ask data for timestamp 1744222380000
09-04-2025 20:14:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:13:00
09-04-2025 20:14:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:14:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:13:00
09-04-2025 20:14:00 - DEBUG - Matched ask with existing bid for timestamp 1744222380000
09-04-2025 20:14:00 - DEBUG - Added midpoint to recent_data. Size: 1
09-04-2025 20:14:58 - DEBUG - Ping sent at 20:14:58
09-04-2025 20:15:00 - DEBUG - Processing bid message with timestamp 1744222440000
09-04-2025 20:15:00 - DEBUG - Stored bid data for timestamp 1744222440000
09-04-2025 20:15:00 - DEBUG - Processing ask message with timestamp 1744222440000
09-04-2025 20:15:00 - DEBUG - Stored ask data for timestamp 1744222440000
09-04-2025 20:15:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:14:00
09-04-2025 20:15:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:15:00 - DEBUG - Matched ask with existing bid for timestamp 1744222440000
09-04-2025 20:15:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:14:00
09-04-2025 20:15:00 - DEBUG - Added midpoint to recent_data. Size: 2
09-04-2025 20:15:58 - DEBUG - Ping sent at 20:15:58
09-04-2025 20:16:00 - DEBUG - Processing bid message with timestamp 1744222500000
09-04-2025 20:16:00 - DEBUG - Stored bid data for timestamp 1744222500000
09-04-2025 20:16:00 - DEBUG - Processing ask message with timestamp 1744222500000
09-04-2025 20:16:00 - DEBUG - Stored ask data for timestamp 1744222500000
09-04-2025 20:16:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:15:00
09-04-2025 20:16:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:16:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:15:00
09-04-2025 20:16:00 - DEBUG - Matched ask with existing bid for timestamp 1744222500000
09-04-2025 20:16:00 - DEBUG - Added midpoint to recent_data. Size: 3
09-04-2025 20:16:58 - DEBUG - Ping sent at 20:16:58
09-04-2025 20:17:00 - DEBUG - Processing bid message with timestamp 1744222560000
09-04-2025 20:17:00 - DEBUG - Stored bid data for timestamp 1744222560000
09-04-2025 20:17:00 - DEBUG - Processing ask message with timestamp 1744222560000
09-04-2025 20:17:00 - DEBUG - Stored ask data for timestamp 1744222560000
09-04-2025 20:17:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:16:00
09-04-2025 20:17:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:17:00 - DEBUG - Matched ask with existing bid for timestamp 1744222560000
09-04-2025 20:17:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:16:00
09-04-2025 20:17:00 - DEBUG - Added midpoint to recent_data. Size: 4
09-04-2025 20:17:58 - DEBUG - Ping sent at 20:17:58
09-04-2025 20:18:01 - DEBUG - Processing bid message with timestamp 1744222620000
09-04-2025 20:18:01 - DEBUG - Stored bid data for timestamp 1744222620000
09-04-2025 20:18:01 - DEBUG - Processing ask message with timestamp 1744222620000
09-04-2025 20:18:01 - DEBUG - Stored ask data for timestamp 1744222620000
09-04-2025 20:18:01 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:17:00
09-04-2025 20:18:01 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:18:01 - DEBUG - Got midpoint from queue: 2025-04-09 20:17:00
09-04-2025 20:18:01 - DEBUG - Matched ask with existing bid for timestamp 1744222620000
09-04-2025 20:18:01 - DEBUG - Added midpoint to recent_data. Size: 5
09-04-2025 20:18:58 - DEBUG - Ping sent at 20:18:58
09-04-2025 20:19:00 - DEBUG - Processing bid message with timestamp 1744222680000
09-04-2025 20:19:00 - DEBUG - Stored bid data for timestamp 1744222680000
09-04-2025 20:19:00 - DEBUG - Processing ask message with timestamp 1744222680000
09-04-2025 20:19:00 - DEBUG - Stored ask data for timestamp 1744222680000
09-04-2025 20:19:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:18:00
09-04-2025 20:19:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:19:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:18:00
09-04-2025 20:19:00 - DEBUG - Matched ask with existing bid for timestamp 1744222680000
09-04-2025 20:19:00 - DEBUG - Added midpoint to recent_data. Size: 6
09-04-2025 20:19:58 - DEBUG - Ping sent at 20:19:58
09-04-2025 20:20:00 - DEBUG - Processing bid message with timestamp 1744222740000
09-04-2025 20:20:00 - DEBUG - Stored bid data for timestamp 1744222740000
09-04-2025 20:20:00 - DEBUG - Processing ask message with timestamp 1744222740000
09-04-2025 20:20:00 - DEBUG - Stored ask data for timestamp 1744222740000
09-04-2025 20:20:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:19:00
09-04-2025 20:20:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:20:00 - DEBUG - Matched ask with existing bid for timestamp 1744222740000
09-04-2025 20:20:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:19:00
09-04-2025 20:20:00 - DEBUG - Added midpoint to recent_data. Size: 7
09-04-2025 20:20:58 - DEBUG - Ping sent at 20:20:58
09-04-2025 20:21:00 - DEBUG - Processing bid message with timestamp 1744222800000
09-04-2025 20:21:00 - DEBUG - Stored bid data for timestamp 1744222800000
09-04-2025 20:21:00 - DEBUG - Processing ask message with timestamp 1744222800000
09-04-2025 20:21:00 - DEBUG - Stored ask data for timestamp 1744222800000
09-04-2025 20:21:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:20:00
09-04-2025 20:21:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:21:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:20:00
09-04-2025 20:21:00 - DEBUG - Matched ask with existing bid for timestamp 1744222800000
09-04-2025 20:21:00 - DEBUG - Added midpoint to recent_data. Size: 8
09-04-2025 20:21:58 - DEBUG - Ping sent at 20:21:58
09-04-2025 20:22:00 - DEBUG - Processing bid message with timestamp 1744222860000
09-04-2025 20:22:00 - DEBUG - Stored bid data for timestamp 1744222860000
09-04-2025 20:22:00 - DEBUG - Processing ask message with timestamp 1744222860000
09-04-2025 20:22:00 - DEBUG - Stored ask data for timestamp 1744222860000
09-04-2025 20:22:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:21:00
09-04-2025 20:22:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:22:00 - DEBUG - Matched ask with existing bid for timestamp 1744222860000
09-04-2025 20:22:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:21:00
09-04-2025 20:22:00 - DEBUG - Added midpoint to recent_data. Size: 9
09-04-2025 20:22:58 - DEBUG - Ping sent at 20:22:58
09-04-2025 20:23:00 - DEBUG - Processing bid message with timestamp 1744222920000
09-04-2025 20:23:00 - DEBUG - Stored bid data for timestamp 1744222920000
09-04-2025 20:23:00 - DEBUG - Processing ask message with timestamp 1744222920000
09-04-2025 20:23:00 - DEBUG - Stored ask data for timestamp 1744222920000
09-04-2025 20:23:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:22:00
09-04-2025 20:23:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:23:00 - DEBUG - Matched ask with existing bid for timestamp 1744222920000
09-04-2025 20:23:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:22:00
09-04-2025 20:23:00 - INFO - Processed 20 market data messages
09-04-2025 20:23:00 - DEBUG - Added midpoint to recent_data. Size: 10
09-04-2025 20:23:00 - INFO - Buffer status: 10 processed points, 0 pending bids, 0 pending asks
09-04-2025 20:23:00 - DEBUG - Getting latest data. recent_data size: 10
09-04-2025 20:23:00 - INFO - Latest data: 2025-04-09 20:22:00 | OHLC: 1.27741/1.27774/1.27707/1.27767
09-04-2025 20:23:00 - INFO - Saved 10 records to /Users/dmartinsen/pers-prog/ai-trading-v3/live/temp_live/live_data_GBPUSD_MINUTE_20250409_201357.csv
09-04-2025 20:23:58 - DEBUG - Ping sent at 20:23:58
09-04-2025 20:23:58 - INFO - Processed 20 market data messages
09-04-2025 20:23:58 - INFO - Buffer status: 10 processed points, 0 pending bids, 0 pending asks
09-04-2025 20:23:58 - DEBUG - Getting latest data. recent_data size: 10
09-04-2025 20:23:58 - INFO - Latest data: 2025-04-09 20:22:00 | OHLC: 1.27741/1.27774/1.27707/1.27767
09-04-2025 20:24:00 - DEBUG - Processing bid message with timestamp 1744222980000
09-04-2025 20:24:00 - DEBUG - Stored bid data for timestamp 1744222980000
09-04-2025 20:24:00 - DEBUG - Processing ask message with timestamp 1744222980000
09-04-2025 20:24:00 - DEBUG - Stored ask data for timestamp 1744222980000
09-04-2025 20:24:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:23:00
09-04-2025 20:24:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:24:00 - DEBUG - Matched ask with existing bid for timestamp 1744222980000
09-04-2025 20:24:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:23:00
09-04-2025 20:24:00 - DEBUG - Added midpoint to recent_data. Size: 11
09-04-2025 20:24:58 - DEBUG - Ping sent at 20:24:58
09-04-2025 20:25:00 - DEBUG - Processing bid message with timestamp 1744223040000
09-04-2025 20:25:00 - DEBUG - Stored bid data for timestamp 1744223040000
09-04-2025 20:25:00 - DEBUG - Processing ask message with timestamp 1744223040000
09-04-2025 20:25:00 - DEBUG - Stored ask data for timestamp 1744223040000
09-04-2025 20:25:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:24:00
09-04-2025 20:25:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:25:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:24:00
09-04-2025 20:25:00 - DEBUG - Matched ask with existing bid for timestamp 1744223040000
09-04-2025 20:25:00 - DEBUG - Added midpoint to recent_data. Size: 12
09-04-2025 20:25:58 - DEBUG - Ping sent at 20:25:58
09-04-2025 20:26:00 - DEBUG - Processing bid message with timestamp 1744223100000
09-04-2025 20:26:00 - DEBUG - Stored bid data for timestamp 1744223100000
09-04-2025 20:26:00 - DEBUG - Processing ask message with timestamp 1744223100000
09-04-2025 20:26:00 - DEBUG - Stored ask data for timestamp 1744223100000
09-04-2025 20:26:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:25:00
09-04-2025 20:26:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:26:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:25:00
09-04-2025 20:26:00 - DEBUG - Matched ask with existing bid for timestamp 1744223100000
09-04-2025 20:26:00 - DEBUG - Added midpoint to recent_data. Size: 13
09-04-2025 20:26:58 - DEBUG - Ping sent at 20:26:58
09-04-2025 20:27:00 - DEBUG - Processing bid message with timestamp 1744223160000
09-04-2025 20:27:00 - DEBUG - Stored bid data for timestamp 1744223160000
09-04-2025 20:27:00 - DEBUG - Processing ask message with timestamp 1744223160000
09-04-2025 20:27:00 - DEBUG - Stored ask data for timestamp 1744223160000
09-04-2025 20:27:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:26:00
09-04-2025 20:27:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:27:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:26:00
09-04-2025 20:27:00 - DEBUG - Matched ask with existing bid for timestamp 1744223160000
09-04-2025 20:27:00 - DEBUG - Added midpoint to recent_data. Size: 14
09-04-2025 20:27:58 - DEBUG - Ping sent at 20:27:58
09-04-2025 20:28:00 - DEBUG - Processing bid message with timestamp 1744223220000
09-04-2025 20:28:00 - DEBUG - Stored bid data for timestamp 1744223220000
09-04-2025 20:28:00 - DEBUG - Processing ask message with timestamp 1744223220000
09-04-2025 20:28:00 - DEBUG - Stored ask data for timestamp 1744223220000
09-04-2025 20:28:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:27:00
09-04-2025 20:28:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:28:00 - DEBUG - Matched ask with existing bid for timestamp 1744223220000
09-04-2025 20:28:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:27:00
09-04-2025 20:28:00 - DEBUG - Added midpoint to recent_data. Size: 15
09-04-2025 20:28:58 - DEBUG - Ping sent at 20:28:58
09-04-2025 20:29:00 - DEBUG - Processing bid message with timestamp 1744223280000
09-04-2025 20:29:00 - DEBUG - Stored bid data for timestamp 1744223280000
09-04-2025 20:29:00 - DEBUG - Processing ask message with timestamp 1744223280000
09-04-2025 20:29:00 - DEBUG - Stored ask data for timestamp 1744223280000
09-04-2025 20:29:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:28:00
09-04-2025 20:29:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:29:00 - DEBUG - Matched ask with existing bid for timestamp 1744223280000
09-04-2025 20:29:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:28:00
09-04-2025 20:29:00 - DEBUG - Added midpoint to recent_data. Size: 16
09-04-2025 20:29:58 - DEBUG - Ping sent at 20:29:58
09-04-2025 20:30:00 - DEBUG - Processing bid message with timestamp 1744223340000
09-04-2025 20:30:00 - DEBUG - Stored bid data for timestamp 1744223340000
09-04-2025 20:30:00 - DEBUG - Processing ask message with timestamp 1744223340000
09-04-2025 20:30:00 - DEBUG - Stored ask data for timestamp 1744223340000
09-04-2025 20:30:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:29:00
09-04-2025 20:30:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:30:00 - DEBUG - Matched ask with existing bid for timestamp 1744223340000
09-04-2025 20:30:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:29:00
09-04-2025 20:30:00 - DEBUG - Added midpoint to recent_data. Size: 17
09-04-2025 20:30:58 - DEBUG - Ping sent at 20:30:58
09-04-2025 20:31:00 - DEBUG - Processing bid message with timestamp 1744223400000
09-04-2025 20:31:00 - DEBUG - Stored bid data for timestamp 1744223400000
09-04-2025 20:31:00 - DEBUG - Processing ask message with timestamp 1744223400000
09-04-2025 20:31:00 - DEBUG - Stored ask data for timestamp 1744223400000
09-04-2025 20:31:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:30:00
09-04-2025 20:31:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:31:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:30:00
09-04-2025 20:31:00 - DEBUG - Matched ask with existing bid for timestamp 1744223400000
09-04-2025 20:31:00 - DEBUG - Added midpoint to recent_data. Size: 18
09-04-2025 20:31:58 - DEBUG - Ping sent at 20:31:58
09-04-2025 20:32:00 - DEBUG - Processing bid message with timestamp 1744223460000
09-04-2025 20:32:00 - DEBUG - Stored bid data for timestamp 1744223460000
09-04-2025 20:32:00 - DEBUG - Processing ask message with timestamp 1744223460000
09-04-2025 20:32:00 - DEBUG - Stored ask data for timestamp 1744223460000
09-04-2025 20:32:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:31:00
09-04-2025 20:32:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:32:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:31:00
09-04-2025 20:32:00 - DEBUG - Matched ask with existing bid for timestamp 1744223460000
09-04-2025 20:32:00 - DEBUG - Added midpoint to recent_data. Size: 19
09-04-2025 20:32:58 - DEBUG - Ping sent at 20:32:58
09-04-2025 20:33:00 - DEBUG - Processing bid message with timestamp 1744223520000
09-04-2025 20:33:00 - DEBUG - Stored bid data for timestamp 1744223520000
09-04-2025 20:33:00 - DEBUG - Processing ask message with timestamp 1744223520000
09-04-2025 20:33:00 - DEBUG - Stored ask data for timestamp 1744223520000
09-04-2025 20:33:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:32:00
09-04-2025 20:33:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:33:00 - DEBUG - Matched ask with existing bid for timestamp 1744223520000
09-04-2025 20:33:00 - INFO - Processed 40 market data messages
09-04-2025 20:33:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:32:00
09-04-2025 20:33:00 - INFO - Buffer status: 19 processed points, 0 pending bids, 0 pending asks
09-04-2025 20:33:00 - DEBUG - Added midpoint to recent_data. Size: 20
09-04-2025 20:33:00 - DEBUG - Getting latest data. recent_data size: 20
09-04-2025 20:33:00 - INFO - Latest data: 2025-04-09 20:32:00 | OHLC: 1.28124/1.28205/1.28114/1.28191
09-04-2025 20:33:00 - INFO - Saved 20 records to /Users/dmartinsen/pers-prog/ai-trading-v3/live/temp_live/live_data_GBPUSD_MINUTE_20250409_201357.csv
09-04-2025 20:33:58 - DEBUG - Ping sent at 20:33:58
09-04-2025 20:33:58 - INFO - Processed 40 market data messages
09-04-2025 20:33:58 - INFO - Buffer status: 20 processed points, 0 pending bids, 0 pending asks
09-04-2025 20:33:58 - DEBUG - Getting latest data. recent_data size: 20
09-04-2025 20:33:58 - INFO - Latest data: 2025-04-09 20:32:00 | OHLC: 1.28124/1.28205/1.28114/1.28191
09-04-2025 20:34:00 - DEBUG - Processing bid message with timestamp 1744223580000
09-04-2025 20:34:00 - DEBUG - Stored bid data for timestamp 1744223580000
09-04-2025 20:34:00 - DEBUG - Processing ask message with timestamp 1744223580000
09-04-2025 20:34:00 - DEBUG - Stored ask data for timestamp 1744223580000
09-04-2025 20:34:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:33:00
09-04-2025 20:34:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:34:00 - DEBUG - Matched ask with existing bid for timestamp 1744223580000
09-04-2025 20:34:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:33:00
09-04-2025 20:34:00 - DEBUG - Added midpoint to recent_data. Size: 21
09-04-2025 20:34:58 - DEBUG - Ping sent at 20:34:58
09-04-2025 20:35:00 - DEBUG - Processing bid message with timestamp 1744223640000
09-04-2025 20:35:00 - DEBUG - Stored bid data for timestamp 1744223640000
09-04-2025 20:35:00 - DEBUG - Processing ask message with timestamp 1744223640000
09-04-2025 20:35:00 - DEBUG - Stored ask data for timestamp 1744223640000
09-04-2025 20:35:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:34:00
09-04-2025 20:35:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:35:00 - DEBUG - Matched ask with existing bid for timestamp 1744223640000
09-04-2025 20:35:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:34:00
09-04-2025 20:35:00 - DEBUG - Added midpoint to recent_data. Size: 22
09-04-2025 20:35:58 - DEBUG - Ping sent at 20:35:58
09-04-2025 20:36:00 - DEBUG - Processing bid message with timestamp 1744223700000
09-04-2025 20:36:00 - DEBUG - Stored bid data for timestamp 1744223700000
09-04-2025 20:36:00 - DEBUG - Processing ask message with timestamp 1744223700000
09-04-2025 20:36:00 - DEBUG - Stored ask data for timestamp 1744223700000
09-04-2025 20:36:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:35:00
09-04-2025 20:36:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:36:00 - DEBUG - Matched ask with existing bid for timestamp 1744223700000
09-04-2025 20:36:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:35:00
09-04-2025 20:36:00 - DEBUG - Added midpoint to recent_data. Size: 23
09-04-2025 20:36:58 - DEBUG - Ping sent at 20:36:58
09-04-2025 20:37:00 - DEBUG - Processing bid message with timestamp 1744223760000
09-04-2025 20:37:00 - DEBUG - Stored bid data for timestamp 1744223760000
09-04-2025 20:37:00 - DEBUG - Processing ask message with timestamp 1744223760000
09-04-2025 20:37:00 - DEBUG - Stored ask data for timestamp 1744223760000
09-04-2025 20:37:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:36:00
09-04-2025 20:37:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:37:00 - DEBUG - Matched ask with existing bid for timestamp 1744223760000
09-04-2025 20:37:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:36:00
09-04-2025 20:37:00 - DEBUG - Added midpoint to recent_data. Size: 24
09-04-2025 20:37:58 - DEBUG - Ping sent at 20:37:58
09-04-2025 20:38:00 - DEBUG - Processing bid message with timestamp 1744223820000
09-04-2025 20:38:00 - DEBUG - Stored bid data for timestamp 1744223820000
09-04-2025 20:38:00 - DEBUG - Processing ask message with timestamp 1744223820000
09-04-2025 20:38:00 - DEBUG - Stored ask data for timestamp 1744223820000
09-04-2025 20:38:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:37:00
09-04-2025 20:38:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:38:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:37:00
09-04-2025 20:38:00 - DEBUG - Matched ask with existing bid for timestamp 1744223820000
09-04-2025 20:38:00 - DEBUG - Added midpoint to recent_data. Size: 25
09-04-2025 20:38:00 - DEBUG - Generated features. New shape: (25, 66)
09-04-2025 20:38:00 - DEBUG - Adding 8 missing expected features: {'open_original', 'high_raw', 'close_original', 'close_raw', 'high_original', 'low_raw', 'open_raw', 'low_original'}
09-04-2025 20:38:00 - DEBUG - Column dtypes: gk_volatility            float64
volume                   float64
open_return              float64
low_return               float64
high_return              float64
volatility_5             float64
price_accel              float64
roc_5                    float64
roc_1                    float64
volatility_10            float64
volatility_20            float64
volatility_30            float64
macd_hist                float64
roc_10                   float64
macd_signal              float64
roc_20                   float64
dist_to_support_20       float64
dist_to_resistance_10    float64
rsi_14                   float64
normalized_atr           float64
stoch_d                  float64
dist_to_support_10       float64
dist_to_resistance_20    float64
macd                     float64
atr_14                   float64
stoch_k                  float64
hour_of_day                int32
ema_200                  float64
open_raw                 float64
high_raw                 float64
low_raw                  float64
close_raw                float64
open_original            float64
high_original            float64
low_original             float64
close_original           float64
day_of_week                int32
month                      int32
sma_50                   float64
ema_50                   float64
dtype: object
09-04-2025 20:38:00 - DEBUG - Final feature set for model: 40 features, 25 rows
09-04-2025 20:38:00 - DEBUG - Running prediction on data with shape (25, 40)
09-04-2025 20:38:00 - DEBUG - Column dtypes: gk_volatility            float64
volume                   float64
open_return              float64
low_return               float64
high_return              float64
volatility_5             float64
price_accel              float64
roc_5                    float64
roc_1                    float64
volatility_10            float64
volatility_20            float64
volatility_30            float64
macd_hist                float64
roc_10                   float64
macd_signal              float64
roc_20                   float64
dist_to_support_20       float64
dist_to_resistance_10    float64
rsi_14                   float64
normalized_atr           float64
stoch_d                  float64
dist_to_support_10       float64
dist_to_resistance_20    float64
macd                     float64
atr_14                   float64
stoch_k                  float64
hour_of_day                int32
ema_200                  float64
open_raw                 float64
high_raw                 float64
low_raw                  float64
close_raw                float64
open_original            float64
high_original            float64
low_original             float64
close_original           float64
day_of_week                int32
month                      int32
sma_50                   float64
ema_50                   float64
dtype: object
09-04-2025 20:38:00 - INFO - Model prediction: [1 1 1 0 1 1 1 1 0 0 1 1 1 1 0 0 0 1 0 0 1 1 0 1 1]
09-04-2025 20:38:58 - DEBUG - Ping sent at 20:38:58
09-04-2025 20:39:00 - DEBUG - Processing bid message with timestamp 1744223880000
09-04-2025 20:39:00 - DEBUG - Stored bid data for timestamp 1744223880000
09-04-2025 20:39:00 - DEBUG - Processing ask message with timestamp 1744223880000
09-04-2025 20:39:00 - DEBUG - Stored ask data for timestamp 1744223880000
09-04-2025 20:39:00 - DEBUG - Created midpoint for GBPUSD at 2025-04-09 20:38:00
09-04-2025 20:39:00 - DEBUG - Added midpoint to queue. Queue size: ~1
09-04-2025 20:39:00 - DEBUG - Got midpoint from queue: 2025-04-09 20:38:00
09-04-2025 20:39:00 - DEBUG - Matched ask with existing bid for timestamp 1744223880000
09-04-2025 20:39:00 - DEBUG - Added midpoint to recent_data. Size: 26
09-04-2025 20:39:00 - DEBUG - Generated features. New shape: (26, 66)
09-04-2025 20:39:00 - DEBUG - Adding 8 missing expected features: {'open_original', 'high_raw', 'close_original', 'close_raw', 'high_original', 'low_raw', 'open_raw', 'low_original'}
09-04-2025 20:39:00 - DEBUG - Column dtypes: gk_volatility            float64
volume                   float64
open_return              float64
low_return               float64
high_return              float64
volatility_5             float64
price_accel              float64
roc_5                    float64
roc_1                    float64
volatility_10            float64
volatility_20            float64
volatility_30            float64
macd_hist                float64
roc_10                   float64
macd_signal              float64
roc_20                   float64
dist_to_support_20       float64
dist_to_resistance_10    float64
rsi_14                   float64
normalized_atr           float64
stoch_d                  float64
dist_to_support_10       float64
dist_to_resistance_20    float64
macd                     float64
atr_14                   float64
stoch_k                  float64
hour_of_day                int32
ema_200                  float64
open_raw                 float64
high_raw                 float64
low_raw                  float64
close_raw                float64
open_original            float64
high_original            float64
low_original             float64
close_original           float64
day_of_week                int32
month                      int32
sma_50                   float64
ema_50                   float64
dtype: object
09-04-2025 20:39:00 - DEBUG - Final feature set for model: 40 features, 26 rows
09-04-2025 20:39:00 - DEBUG - Running prediction on data with shape (26, 40)
09-04-2025 20:39:00 - DEBUG - Column dtypes: gk_volatility            float64
volume                   float64
open_return              float64
low_return               float64
high_return              float64
volatility_5             float64
price_accel              float64
roc_5                    float64
roc_1                    float64
volatility_10            float64
volatility_20            float64
volatility_30            float64
macd_hist                float64
roc_10                   float64
macd_signal              float64
roc_20                   float64
dist_to_support_20       float64
dist_to_resistance_10    float64
rsi_14                   float64
normalized_atr           float64
stoch_d                  float64
dist_to_support_10       float64
dist_to_resistance_20    float64
macd                     float64
atr_14                   float64
stoch_k                  float64
hour_of_day                int32
ema_200                  float64
open_raw                 float64
high_raw                 float64
low_raw                  float64
close_raw                float64
open_original            float64
high_original            float64
low_original             float64
close_original           float64
day_of_week                int32
month                      int32
sma_50                   float64
ema_50                   float64
dtype: object
09-04-2025 20:39:00 - INFO - Model prediction: [1 1 1 0 1 0 1 1 0 0 1 1 1 1 0 0 0 1 1 1 1 1 0 1 1 1]
09-04-2025 20:39:19 - INFO - Received keyboard interrupt, shutting down...
09-04-2025 20:39:19 - INFO - Saved 26 records to /Users/dmartinsen/pers-prog/ai-trading-v3/live/temp_live/live_data_GBPUSD_MINUTE_20250409_201357.csv
09-04-2025 20:39:20 - INFO - Ending session with Capital.com...
09-04-2025 20:39:20 - CRITICAL - Uncaught exception
Traceback (most recent call last):
  File "/Users/dmartinsen/pers-prog/ai-trading-v3/live/run_live_integration.py", line 276, in main
    subscribe_and_process_data(
  File "/Users/dmartinsen/pers-prog/ai-trading-v3/live/run_live_integration.py", line 244, in subscribe_and_process_data
    data_handler.stop()
  File "/Users/dmartinsen/pers-prog/ai-trading-v3/live/live_data_handling/live_data_handler.py", line 99, in stop
    self.processor_thread.join(timeout=5.0)
  File "/opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/lib/python3.10/threading.py", line 1100, in join
    self._wait_for_tstate_lock(timeout=max(timeout, 0))
  File "/opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dmartinsen/pers-prog/ai-trading-v3/main.py", line 163, in <module>
    exit(main())
  File "/Users/dmartinsen/pers-prog/ai-trading-v3/main.py", line 160, in main
    run_live_integration.main(duration_minutes=60)
  File "/Users/dmartinsen/pers-prog/ai-trading-v3/live/run_live_integration.py", line 291, in main
    broker.end_session()
  File "/Users/dmartinsen/pers-prog/ai-trading-v3/broker/capital_com/capitalcom.py", line 48, in end_session
    return session.end_session(X_SECURITY_TOKEN=X_SECURITY_TOKEN or self.x_security_token, CST=CST or self.cst)
  File "/Users/dmartinsen/pers-prog/ai-trading-v3/broker/capital_com/rest_api/session.py", line 85, in end_session
    res = conn.getresponse()
  File "/opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/lib/python3.10/http/client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response
